有乐观锁，分别是 总量、没有卖出、真正卖出
100 63 37
1000 689 311
10000 5884 4116
10000 5928 4072

没有乐观锁，总量、没有卖出
100 88

jmeter测试 总量、没有卖出、真正卖出
100 53 47
100 48 52
1000 848 152
1000 330 670 (1000 5s QPS 200)
10000 8322 1678 (10000 5s 有效qps 335)

不用MQ 总量、没有卖出、真正卖出
100 20 80
1000 736 264
1000 719 281
10000 7899 2101 (10000 8s 有效qps 262)
10000 8280 1720 (10000 6s 有效qps 286)
10000 7904 2096

预减库存代码优化后 总量、没有卖出、真正卖出
100 54 46
1000 750 250
10000 8264 1736 (10000 6s 有效qps 289)

即便去掉了redis减少库存的代码
10000 8232 1768

只用一个线程，不用MQ 全部命中 用时37s 有效qps 270

只用一个线程，用MQ
10000 3864 6136 （16s 有效qps 383）

109秒，吞吐量定时器限制，每分钟吞吐量6000，每秒100，线程只开一个, 有效QPS 91
10000 84 9916

56秒 线程数2 每秒限制100 有效QPS90
10000 4949 5051

56秒 线程数1 每秒限制200 有效QPS 173
10000 306 9694

34秒 线程数1 每秒限制300 有效QPS 271
10000 785 9215

32s 线程数1 每秒限制400 有效QPS 297
10000 471 9529

22s 线程数1 每秒限制500 有效QPS 359
10000 2081 7919

23s 线程数1 每秒限制600 有效QPS 346
10000 2027 7973

14s 线程数1 每秒限制700 有效QPS 444
10000 3772 6228

14s 线程数1 每秒限制800 有效QPS 448
10000 3723 6277

12s 线程数1 每秒限制无限制 有效QPS 486
10000 4164 5836

106s 线程数1 没有MQ无限制 有效QPS 94
10000全部命中

8s 线程数5 没有MQ 有效QPS 261
10000 7906 2094

6s 线程数5 使用MQ 有效QPS 249
10000 8506 1494

更换高可用RabbitMQ代码后
7s 线程数5 全部命中 有效QPS 1428 有20s-30s的消息队列处理时间

------------------------------------
TRUNCATE TABLE seckill_order;
TRUNCATE TABLE order_info;
UPDATE seckill_goods SET stock_count = 10000 WHERE id = 1;
UPDATE seckill_goods SET version = 0 WHERE id = 1;